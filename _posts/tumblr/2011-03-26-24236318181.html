---
layout: post
title: Samba配置与使用
---

<p><strong>介绍</strong></p>

<p>Samba可以让我们在windows中访问linux系统中的文件，如果用来调试linux虚拟机中的代码会非常的方便。</p>

<p><strong>安装</strong></p>

<p>以下是CentOS中Samba的安装方式：</p>

<pre>yum install samba

/etc/init.d/samba start

</pre>

<p>添加用户到Samba中,这个用户就可以用来访问Samba中的文件：</p>

<pre>groupadd sambagroup

useradd -g sambagroup sambauser1

passwd sambauser1 #shell 登录用

smbpasswd -a sambauser1 #samba登录用

smbpasswd sambauser1   #修改samba用户sambauser1的密码

</pre>

<p><strong>配置</strong></p>

<p>Samba配置文件为/etc/samba/smb.conf 用户验证访问模式：</p>

<pre>[global]

workgroup = Ubuntu

netbios name = UbuntuServer

server string = Linux Samba Server TestServer

security = user

encrypt passwords = yes

smb passwd file = /etc/samba/smbpasswd

display charset = cp936

unix charset = cp936

dos  charset = cp936

[noshare]

path = /home/sambauser1

writeable = yes   

browseable = yes

create mask =  0664

directory mask = 0775

valid users = sambauser1 #允许访问的用户，多个以','分割

</pre>

<p>匿名访问方式：</p>

<pre>[global]

workgroup = Ubuntu

netbios name = UbuntuServer

server string = Linux Samba Server TestServer

security = share

display charset = cp936

unix charset = cp936

dos  charset = cp936

[share]

path = /share/smb

writeable = yes

browseable = yes

create mask =  0664

directory mask = 0775

guest ok = yes #允许匿名访问

public = yes

</pre>

<p><strong>问题</strong></p>

<p>最近在配置samba，windows连接的时候出现如下问题： <em>“samba不允许一个用户使用一个以上用户名与一个服务器或共享资源的多重连接”</em>google查询后，找到解决方法：</p>

<pre>net use * /del /y

</pre>

<p><em> “事实上这个不是samba的限制，是Windows的限制。始终要用public＝yes的话，上面的方法都不能有效解决，因为：在打开存在public＝yes的samba服务器时，如果首先点击了有public＝yes的共享资源的时候，widows会用默认的用户名去连接服务器，一般就是windows的登录名（可以在服务器端查看到的），这时候，再去点击没有public＝yes的共享资源，由于使用了user级别，服务器就会要求验证，这时，之前的默认登录已经存在，就出现了楼主的故障了。即使注销连接后如果没有采用正确的顺序访问共享资源，还是会陷入这个泥潭中。因此，最好办法就是不用public＝yes，给公共帐号建立一个共用的账户并公示出来。这样处理，其实权限更清晰一些。 ”</em></p>

<p><strong>Selinux</strong></p>

<p>在配置好samba后，有时候还会出现无法访问的情况，这种情况下需要关闭Selinux：</p>

<pre>vi /etc/selinux/config

#修改 SELINUX=enforcing 为 SELINUX=disabled

#重启服务器

</pre>

<p>Updated:  2011.10.8 Selinux</p>

<p>参考：<br/> <a href="http://www.linuxsir.org/main/?q=node/158" target="_blank">http://www.linuxsir.org/main/?q=node/158</a><br/> <a href="http://blogold.chinaunix.net/u/19637/showart_491257.html" target="_blank">http://blogold.chinaunix.net/u/19637/showart_491257.html</a></p>
